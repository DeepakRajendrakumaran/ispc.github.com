<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Intel SPMD Program Compiler: GatherScatterFlattenOpt Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a>  </div>
  <div class="headertitle">
<h1>GatherScatterFlattenOpt Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="GatherScatterFlattenOpt" --><!-- doxytag: inherits="llvm::BasicBlockPass" --><!-- startSectionHeader --><div class="dynheader">
Inheritance diagram for GatherScatterFlattenOpt:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="classGatherScatterFlattenOpt__inherit__graph.png" border="0" usemap="#GatherScatterFlattenOpt_inherit__map" alt="Inheritance graph"/></div>
<map name="GatherScatterFlattenOpt_inherit__map" id="GatherScatterFlattenOpt_inherit__map">
<area shape="rect" id="node2" href="classllvm_1_1BasicBlockPass.html" title="BasicBlockPass" alt="" coords="37,6,160,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center><!-- endSectionContent --></div>
<!-- startSectionHeader --><div class="dynheader">
Collaboration diagram for GatherScatterFlattenOpt:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="classGatherScatterFlattenOpt__coll__graph.png" border="0" usemap="#GatherScatterFlattenOpt_coll__map" alt="Collaboration graph"/></div>
<map name="GatherScatterFlattenOpt_coll__map" id="GatherScatterFlattenOpt_coll__map">
<area shape="rect" id="node2" href="classllvm_1_1BasicBlockPass.html" title="BasicBlockPass" alt="" coords="5,6,128,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center><!-- endSectionContent --></div>

<p><a href="classGatherScatterFlattenOpt-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGatherScatterFlattenOpt.html#ae8eea21bc733548fc2a2f975f71e85fa">GatherScatterFlattenOpt</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGatherScatterFlattenOpt.html#a9007fe357a9d918909b8619bf5a1957f">getPassName</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGatherScatterFlattenOpt.html#a8eedf7f00a7388f71576092749ca60bc">runOnBasicBlock</a> (llvm::BasicBlock &amp;BB)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGatherScatterFlattenOpt.html#a22fccfa7b7a5546e6dff6a5bdcd7a1e3">ID</a> = 0</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>When the front-end emits gathers and scatters, it generates an array of vector-width pointers to represent the set of addresses to read from or write to. However, because ispc doesn't support pointers, it turns out to be the case that scatters and gathers always end up indexing into an array with a common base pointer. Therefore, this optimization transforms the original arrays of general pointers into a single base pointer and an array of offsets.</p>
<p>(Implementation seems to be easier with this approach versus having the front-end try to emit base pointer + offset stuff from the start, though arguably the latter approach would be a little more elegant.)</p>
<p>See for example the comments discussing the __pseudo_gather functions in <a class="el" href="builtins_8cpp.html" title="Definitions of functions related to setting up the standard library and other builtins.">builtins.cpp</a> for more information about this.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>The implementation of this is pretty messy, and it sure would be nice to not have all the complexity of built-in assumptions of the structure of how the front end will have generated code, all of the instruction dyn_casts, etc. Can we do something simpler, e.g. an early pass to flatten out GEPs when the size is known, then do LLVM's constant folding, then flatten into an array, etc.? </dd></dl>

<p>Definition at line <a class="el" href="opt_8cpp_source.html#l00727">727</a> of file <a class="el" href="opt_8cpp_source.html">opt.cpp</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae8eea21bc733548fc2a2f975f71e85fa"></a><!-- doxytag: member="GatherScatterFlattenOpt::GatherScatterFlattenOpt" ref="ae8eea21bc733548fc2a2f975f71e85fa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GatherScatterFlattenOpt::GatherScatterFlattenOpt </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="opt_8cpp_source.html#l00730">730</a> of file <a class="el" href="opt_8cpp_source.html">opt.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a9007fe357a9d918909b8619bf5a1957f"></a><!-- doxytag: member="GatherScatterFlattenOpt::getPassName" ref="a9007fe357a9d918909b8619bf5a1957f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* GatherScatterFlattenOpt::getPassName </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="opt_8cpp_source.html#l00732">732</a> of file <a class="el" href="opt_8cpp_source.html">opt.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8eedf7f00a7388f71576092749ca60bc"></a><!-- doxytag: member="GatherScatterFlattenOpt::runOnBasicBlock" ref="a8eedf7f00a7388f71576092749ca60bc" args="(llvm::BasicBlock &amp;BB)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GatherScatterFlattenOpt::runOnBasicBlock </td>
          <td>(</td>
          <td class="paramtype">llvm::BasicBlock &amp;&#160;</td>
          <td class="paramname"> <em>BB</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="opt_8cpp_source.html#l01123">1123</a> of file <a class="el" href="opt_8cpp_source.html">opt.cpp</a>.</p>

<p>References <a class="el" href="parse_8yy.html">assert</a>, <a class="el" href="opt_8cpp_source.html#l01116">GSInfo::baseOffsetsFunc</a>, <a class="el" href="opt_8cpp_source.html#l01118">GSInfo::elementSize</a>, <a class="el" href="opt_8cpp_source.html#l01115">GSInfo::func</a>, <a class="el" href="opt_8cpp_source.html#l01117">GSInfo::isGather</a>, <a class="el" href="opt_8cpp_source.html#l00107">lCopyMetadata()</a>, <a class="el" href="opt_8cpp_source.html#l01043">lGetPtrAndOffsets()</a>, <a class="el" href="parse_8yy.html">NULL</a>, and <a class="el" href="llvmutil_8h_source.html#l00054">LLVMTypes::VoidPointerType</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a22fccfa7b7a5546e6dff6a5bdcd7a1e3"></a><!-- doxytag: member="GatherScatterFlattenOpt::ID" ref="a22fccfa7b7a5546e6dff6a5bdcd7a1e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="classGatherScatterFlattenOpt.html#a22fccfa7b7a5546e6dff6a5bdcd7a1e3">GatherScatterFlattenOpt::ID</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="opt_8cpp_source.html#l00729">729</a> of file <a class="el" href="opt_8cpp_source.html">opt.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="opt_8cpp_source.html">opt.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Sep 30 2011 14:55:38 for Intel SPMD Program Compiler by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>

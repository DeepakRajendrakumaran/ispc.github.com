<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Intel SPMD Program Compiler: builtins.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>builtins.cpp File Reference</h1>  </div>
</div>
<div class="contents">

<p>Definitions of functions related to setting up the standard library and other builtins.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="builtins_8h_source.html">builtins.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="type_8h_source.html">type.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sym_8h_source.html">sym.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="expr_8h_source.html">expr.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="llvmutil_8h_source.html">llvmutil.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="module_8h_source.html">module.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ctx_8h_source.html">ctx.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="stdlib_8h_source.html">stdlib.h</a>&gt;</code><br/>
<code>#include &lt;llvm/LLVMContext.h&gt;</code><br/>
<code>#include &lt;llvm/Module.h&gt;</code><br/>
<code>#include &lt;llvm/Type.h&gt;</code><br/>
<code>#include &lt;llvm/DerivedTypes.h&gt;</code><br/>
<code>#include &lt;llvm/Instructions.h&gt;</code><br/>
<code>#include &lt;llvm/Linker.h&gt;</code><br/>
<code>#include &lt;llvm/Support/MemoryBuffer.h&gt;</code><br/>
<code>#include &lt;llvm/Bitcode/ReaderWriter.h&gt;</code><br/>
<!-- startSectionHeader --><div class="dynheader">
Include dependency graph for builtins.cpp:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="builtins_8cpp__incl.png" border="0" usemap="#builtins_8cpp" alt=""/></div>
<map name="builtins_8cpp" id="builtins_8cpp">
<area shape="rect" id="node3" href="builtins_8h.html" title="Declarations of functions related to builtins and the standard library." alt="" coords="549,161,632,189"/><area shape="rect" id="node21" href="type_8h.html" title="File with declarations for classes related to type representation." alt="" coords="125,161,189,189"/><area shape="rect" id="node28" href="util_8h.html" title="util.h" alt="" coords="287,83,343,111"/><area shape="rect" id="node31" href="sym_8h.html" title="header file with declarations for symbol and symbol table classes." alt="" coords="372,83,433,111"/><area shape="rect" id="node36" href="expr_8h.html" title="Expr abstract base class and expression implementations." alt="" coords="195,83,259,111"/><area shape="rect" id="node40" href="llvmutil_8h.html" title="Header file with declarations for various LLVM utility stuff." alt="" coords="440,161,525,189"/><area shape="rect" id="node49" href="module_8h.html" title="Declaration of the Module class, which is the ispc&#45;side representation of the results of compiling a ..." alt="" coords="805,83,891,111"/><area shape="rect" id="node52" href="ctx_8h.html" title="Declaration of the FunctionEmitContext class." alt="" coords="957,83,1013,111"/><area shape="rect" id="node63" href="math_8h.html" title="math.h" alt="" coords="1552,83,1621,111"/><area shape="rect" id="node65" href="stdlib_8h.html" title="stdlib.h" alt="" coords="1645,83,1717,111"/><area shape="rect" id="node5" href="ispc_8h.html" title="Main ispc.header file." alt="" coords="320,238,381,266"/><area shape="rect" id="node7" href="assert_8h.html" title="assert.h" alt="" coords="588,393,663,421"/><area shape="rect" id="node11" href="stdint_8h.html" title="stdint.h" alt="" coords="508,315,580,343"/><area shape="rect" id="node9" href="cdefs_8h.html" title="sys/cdefs.h" alt="" coords="973,470,1069,498"/><area shape="rect" id="node67" href="Availability_8h.html" title="Availability.h" alt="" coords="2208,161,2315,189"/><area shape="rect" id="node71" href="__types_8h.html" title="_types.h" alt="" coords="1949,315,2029,343"/><area shape="rect" id="node80" href="wait_8h.html" title="sys/wait.h" alt="" coords="1595,161,1683,189"/><area shape="rect" id="node115" href="alloca_8h.html" title="alloca.h" alt="" coords="2029,238,2104,266"/><area shape="rect" id="node122" href="types_8h.html" title="machine/types.h" alt="" coords="2051,161,2184,189"/><area shape="rect" id="node69" href="AvailabilityInternal_8h.html" title="AvailabilityInternal.h" alt="" coords="2180,238,2343,266"/><area shape="rect" id="node73" href="__types_8h.html" title="sys/_types.h" alt="" coords="1496,393,1600,421"/><area shape="rect" id="node77" href="__types_8h.html" title="machine/_types.h" alt="" coords="1424,470,1565,498"/><area shape="rect" id="node85" href="signal_8h.html" title="sys/signal.h" alt="" coords="1068,238,1169,266"/><area shape="rect" id="node101" href="resource_8h.html" title="sys/resource.h" alt="" coords="1501,238,1621,266"/><area shape="rect" id="node111" href="endian_8h.html" title="machine/endian.h" alt="" coords="1731,238,1875,266"/><area shape="rect" id="node88" href="appleapiopts_8h.html" title="sys/appleapiopts.h" alt="" coords="1299,315,1448,343"/><area shape="rect" id="node90" href="signal_8h.html" title="machine/signal.h" alt="" coords="896,315,1035,343"/><area shape="rect" id="node93" href="__structs_8h.html" title="sys/_structs.h" alt="" coords="1109,315,1224,343"/></map>
<!-- endSectionContent --></div>

<p><a href="builtins_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#acd8617a8f2ac0de8bc1cc032cf449e19">yyparse</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">yy_buffer_state *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a14866839501f9788fa33614be98acd4f">yy_scan_string</a> (const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType.html">Type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a1321254c115cc19f6b414c8eceb0ff7f">lLLVMTypeToISPCType</a> (const llvm::Type *t, bool intAsUnsigned)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a81398a326620dd285b8e6a26061b5a35">lCreateISPCSymbol</a> (llvm::Function *func, <a class="el" href="classSymbolTable.html">SymbolTable</a> *symbolTable)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a5554f69d9b8a595fa07c03b7bf942434">lAddModuleSymbols</a> (llvm::Module *module, <a class="el" href="classSymbolTable.html">SymbolTable</a> *symbolTable)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#afe97d6ae617d251fe4219aa33aa8a30b">lDeclarePseudoGathers</a> (llvm::Module *module)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a80466523cbb450f98e2366d05ae3f6b8">lDeclarePseudoScatters</a> (llvm::Module *module)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#aca3a5dcf139324a4ba845093d76ae8c3">lDeclarePseudoMaskedStore</a> (llvm::Module *module)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a012eaa60308288ebf6f8f48d50250b5d">lAddBitcode</a> (const unsigned char *bitcode, int length, llvm::Module *module, <a class="el" href="classSymbolTable.html">SymbolTable</a> *symbolTable)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#ac856ea2f0d194438ddf3b45476a32ed6">lDefineConstantInt</a> (const char *name, int val, llvm::Module *module, <a class="el" href="classSymbolTable.html">SymbolTable</a> *symbolTable)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#af3cb7d2a18e821d2d1cac65334f55e45">lDefineProgramIndex</a> (llvm::Module *module, <a class="el" href="classSymbolTable.html">SymbolTable</a> *symbolTable)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="builtins_8cpp.html#a356bc9bc8aebc682d51966e145f82b70">DefineStdlib</a> (<a class="el" href="classSymbolTable.html">SymbolTable</a> *symbolTable, llvm::LLVMContext *ctx, llvm::Module *module, bool includeStdlibISPC)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Definitions of functions related to setting up the standard library and other builtins. </p>

<p>Definition in file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a356bc9bc8aebc682d51966e145f82b70"></a><!-- doxytag: member="builtins.cpp::DefineStdlib" ref="a356bc9bc8aebc682d51966e145f82b70" args="(SymbolTable *symbolTable, llvm::LLVMContext *ctx, llvm::Module *module, bool includeStdlibISPC)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DefineStdlib </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSymbolTable.html">SymbolTable</a> *&#160;</td>
          <td class="paramname"> <em>symbolTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llvm::LLVMContext *&#160;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"> <em>includeStdlib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds declarations and definitions of ispc standard library functions and types to the given module.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">symbolTable</td><td><a class="el" href="classSymbolTable.html" title="Symbol table that holds all known symbols during parsing and compilation.">SymbolTable</a> in which to add symbol definitions for stdlib stuff </td></tr>
    <tr><td class="paramname">ctx</td><td>llvm::LLVMContext to use for getting types and the like for standard library definitions </td></tr>
    <tr><td class="paramname">module</td><td><a class="el" href="classModule.html">Module</a> in which to add the declarations/definitions </td></tr>
    <tr><td class="paramname">includeStdlib</td><td>Indicates whether the definitions from the stdlib.ispc file should be added to the module. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00506">506</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="ispc_8h_source.html#l00163">Target::AVX</a>, <a class="el" href="ispc_8h_source.html#l00308">Globals::ctx</a>, <a class="el" href="util_8h_source.html#l00104">FATAL</a>, <a class="el" href="ispc_8cpp_source.html#l00054">g</a>, <a class="el" href="llvmutil_8h_source.html#l00058">LLVMTypes::Int32Type</a>, <a class="el" href="ispc_8h_source.html#l00166">Target::isa</a>, <a class="el" href="builtins_8cpp_source.html#l00450">lAddBitcode()</a>, <a class="el" href="builtins_8cpp_source.html#l00263">lDeclarePseudoGathers()</a>, <a class="el" href="builtins_8cpp_source.html#l00402">lDeclarePseudoMaskedStore()</a>, <a class="el" href="builtins_8cpp_source.html#l00329">lDeclarePseudoScatters()</a>, <a class="el" href="builtins_8cpp_source.html#l00471">lDefineConstantInt()</a>, <a class="el" href="builtins_8cpp_source.html#l00486">lDefineProgramIndex()</a>, <a class="el" href="ispc_8h_source.html#l00275">Globals::Math_ISPC</a>, <a class="el" href="ispc_8h_source.html#l00275">Globals::Math_ISPCFast</a>, <a class="el" href="ispc_8h_source.html#l00275">Globals::Math_SVML</a>, <a class="el" href="ispc_8h_source.html#l00275">Globals::Math_System</a>, <a class="el" href="ispc_8h_source.html#l00276">Globals::mathLib</a>, <a class="el" href="ispc_8h_source.html#l00163">Target::SSE2</a>, <a class="el" href="ispc_8h_source.html#l00163">Target::SSE4</a>, <a class="el" href="ispc_8h_source.html#l00271">Globals::target</a>, <a class="el" href="ispc_8h_source.html#l00182">Target::vectorWidth</a>, <a class="el" href="llvmutil_8h_source.html#l00054">LLVMTypes::VoidPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00053">LLVMTypes::VoidType</a>, <a class="el" href="builtins_8cpp.html#a14866839501f9788fa33614be98acd4f">yy_scan_string()</a>, and <a class="el" href="builtins_8cpp.html#acd8617a8f2ac0de8bc1cc032cf449e19">yyparse()</a>.</p>

<p>Referenced by <a class="el" href="module_8cpp_source.html#l00145">Module::CompileFile()</a>.</p>

</div>
</div>
<a class="anchor" id="a012eaa60308288ebf6f8f48d50250b5d"></a><!-- doxytag: member="builtins.cpp::lAddBitcode" ref="a012eaa60308288ebf6f8f48d50250b5d" args="(const unsigned char *bitcode, int length, llvm::Module *module, SymbolTable *symbolTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lAddBitcode </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"> <em>bitcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSymbolTable.html">SymbolTable</a> *&#160;</td>
          <td class="paramname"> <em>symbolTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This utility function takes serialized binary LLVM bitcode and adds its definitions to the given module. Functions in the bitcode that can be mapped to ispc functions are also added to the symbol table.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">bitcode</td><td>Binary LLVM bitcode (e.g. the contents of a *.bc file) </td></tr>
    <tr><td class="paramname">length</td><td>Length of the bitcode buffer </td></tr>
    <tr><td class="paramname">module</td><td><a class="el" href="classModule.html">Module</a> to link the bitcode into </td></tr>
    <tr><td class="paramname">symbolTable</td><td><a class="el" href="classSymbol.html" title="Representation of a program symbol.">Symbol</a> table to add definitions to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00450">450</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="ispc_8h_source.html#l00308">Globals::ctx</a>, <a class="el" href="util_8cpp_source.html#l00260">Error()</a>, <a class="el" href="ispc_8cpp_source.html#l00054">g</a>, and <a class="el" href="builtins_8cpp_source.html#l00226">lAddModuleSymbols()</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="a5554f69d9b8a595fa07c03b7bf942434"></a><!-- doxytag: member="builtins.cpp::lAddModuleSymbols" ref="a5554f69d9b8a595fa07c03b7bf942434" args="(llvm::Module *module, SymbolTable *symbolTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lAddModuleSymbols </td>
          <td>(</td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSymbolTable.html">SymbolTable</a> *&#160;</td>
          <td class="paramname"> <em>symbolTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Given an LLVM module, create ispc symbols for the functions in the module. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00226">226</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="parse_8yy.html">assert</a>, and <a class="el" href="builtins_8cpp_source.html#l00147">lCreateISPCSymbol()</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00450">lAddBitcode()</a>.</p>

</div>
</div>
<a class="anchor" id="a81398a326620dd285b8e6a26061b5a35"></a><!-- doxytag: member="builtins.cpp::lCreateISPCSymbol" ref="a81398a326620dd285b8e6a26061b5a35" args="(llvm::Function *func, SymbolTable *symbolTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool lCreateISPCSymbol </td>
          <td>(</td>
          <td class="paramtype">llvm::Function *&#160;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSymbolTable.html">SymbolTable</a> *&#160;</td>
          <td class="paramname"> <em>symbolTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Given an LLVM function declaration, synthesize the equivalent ispc symbol for the function (if possible). Returns true on success, false on failure. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00147">147</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="sym_8cpp_source.html#l00150">SymbolTable::AddFunction()</a>, <a class="el" href="type_8cpp_source.html#l02007">Type::Equal()</a>, <a class="el" href="sym_8h_source.html#l00081">Symbol::function</a>, <a class="el" href="builtins_8cpp_source.html#l00078">lLLVMTypeToISPCType()</a>, <a class="el" href="ispc_8h_source.html#l00109">SourcePos::name</a>, <a class="el" href="parse_8yy.html">NULL</a>, <a class="el" href="type_8cpp_source.html#l01822">FunctionType::SetArgumentDefaults()</a>, <a class="el" href="type_8h_source.html#l00223">AtomicType::VaryingBool</a>, and <a class="el" href="type_8h_source.html#l00224">AtomicType::VaryingInt32</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00226">lAddModuleSymbols()</a>.</p>

</div>
</div>
<a class="anchor" id="afe97d6ae617d251fe4219aa33aa8a30b"></a><!-- doxytag: member="builtins.cpp::lDeclarePseudoGathers" ref="afe97d6ae617d251fe4219aa33aa8a30b" args="(llvm::Module *module)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lDeclarePseudoGathers </td>
          <td>(</td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Declare the 'pseudo-gather' functions. When the ispc front-end needs to perform a gather, it generates a call to one of these functions, which have signatures:</p>
<p>varying int32 __pseudo_gather(varying int32 *, mask) varying int64 __pseudo_gather(varying int64 *, mask)</p>
<p>These functions are never actually implemented; the <a class="el" href="classGatherScatterFlattenOpt.html">GatherScatterFlattenOpt</a> optimization pass finds them and then converts them to make calls to the following functions, which represent gathers from a common base pointer with offsets. This approach allows the front-end to be relatively simple in how it emits address calculation for gathers.</p>
<p>varying int32 __pseudo_gather_base_offsets_32(uniform int32 *base, int32 offsets, mask) varying int64 __pseudo_gather_base_offsets_64(uniform int64 *base, int64 offsets, mask)</p>
<p>Then, the <a class="el" href="classGSImprovementsPass.html">GSImprovementsPass</a> optimizations finds these and either converts them to native gather functions or converts them to vector loads, if equivalent. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00263">263</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="llvmutil_8h_source.html#l00070">LLVMTypes::Int32VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00072">LLVMTypes::Int64VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00067">LLVMTypes::MaskType</a>, <a class="el" href="ispc_8h_source.html#l00109">SourcePos::name</a>, <a class="el" href="llvmutil_8h_source.html#l00054">LLVMTypes::VoidPointerType</a>, and <a class="el" href="llvmutil_8h_source.html#l00078">LLVMTypes::VoidPointerVectorType</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="aca3a5dcf139324a4ba845093d76ae8c3"></a><!-- doxytag: member="builtins.cpp::lDeclarePseudoMaskedStore" ref="aca3a5dcf139324a4ba845093d76ae8c3" args="(llvm::Module *module)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lDeclarePseudoMaskedStore </td>
          <td>(</td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function declares placeholder masked store functions for the front-end to use.</p>
<p>void __pseudo_masked_store_32(uniform int32 *ptr, varying int32 values, mask) void __pseudo_masked_store_64(uniform int64 *ptr, varying int64 values, mask)</p>
<p>These in turn are converted to native masked stores or to regular stores (if the mask is all on) by the <a class="el" href="classMaskedStoreOptPass.html">MaskedStoreOptPass</a> optimization pass. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00402">402</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="llvmutil_8h_source.html#l00071">LLVMTypes::Int32VectorPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00070">LLVMTypes::Int32VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00073">LLVMTypes::Int64VectorPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00072">LLVMTypes::Int64VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00067">LLVMTypes::MaskType</a>, <a class="el" href="ispc_8h_source.html#l00109">SourcePos::name</a>, and <a class="el" href="llvmutil_8h_source.html#l00053">LLVMTypes::VoidType</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="a80466523cbb450f98e2366d05ae3f6b8"></a><!-- doxytag: member="builtins.cpp::lDeclarePseudoScatters" ref="a80466523cbb450f98e2366d05ae3f6b8" args="(llvm::Module *module)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lDeclarePseudoScatters </td>
          <td>(</td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Similarly to the 'pseudo-gathers' defined by <a class="el" href="builtins_8cpp.html#afe97d6ae617d251fe4219aa33aa8a30b">lDeclarePseudoGathers()</a>, we also declare (but never define) pseudo-scatter instructions with signatures:</p>
<p>void __pseudo_scatter_32(varying int32 *, varying int32 values, mask) void __pseudo_scatter_64(varying int64 *, varying int64 values, mask)</p>
<p>The <a class="el" href="classGatherScatterFlattenOpt.html">GatherScatterFlattenOpt</a> optimization pass also finds these and transforms them to scatters like:</p>
<p>void __pseudo_scatter_base_offsets_32(uniform int32 *base, varying int32 offsets, varying int32 values, mask) void __pseudo_scatter_base_offsets_64(uniform int64 *base, varying int62 offsets, varying int64 values, mask)</p>
<p>And the <a class="el" href="classGSImprovementsPass.html">GSImprovementsPass</a> in turn converts these to actual native scatters or masked stores. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00329">329</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="llvmutil_8h_source.html#l00070">LLVMTypes::Int32VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00072">LLVMTypes::Int64VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00067">LLVMTypes::MaskType</a>, <a class="el" href="ispc_8h_source.html#l00109">SourcePos::name</a>, <a class="el" href="llvmutil_8h_source.html#l00054">LLVMTypes::VoidPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00078">LLVMTypes::VoidPointerVectorType</a>, and <a class="el" href="llvmutil_8h_source.html#l00053">LLVMTypes::VoidType</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="ac856ea2f0d194438ddf3b45476a32ed6"></a><!-- doxytag: member="builtins.cpp::lDefineConstantInt" ref="ac856ea2f0d194438ddf3b45476a32ed6" args="(const char *name, int val, llvm::Module *module, SymbolTable *symbolTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lDefineConstantInt </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"> <em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSymbolTable.html">SymbolTable</a> *&#160;</td>
          <td class="paramname"> <em>symbolTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Utility routine that defines a constant int32 with given value, adding the symbol to both the ispc symbol table and the given LLVM module. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00471">471</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="sym_8cpp_source.html#l00097">SymbolTable::AddVariable()</a>, <a class="el" href="sym_8h_source.html#l00087">Symbol::constValue</a>, <a class="el" href="llvmutil_8h_source.html#l00058">LLVMTypes::Int32Type</a>, <a class="el" href="sym_8h_source.html#l00096">Symbol::isStatic</a>, <a class="el" href="llvmutil_8cpp_source.html#l00136">LLVMInt32()</a>, <a class="el" href="sym_8h_source.html#l00076">Symbol::name</a>, <a class="el" href="sym_8h_source.html#l00077">Symbol::storagePtr</a>, <a class="el" href="sym_8h_source.html#l00084">Symbol::type</a>, and <a class="el" href="type_8h_source.html#l00231">AtomicType::UniformConstInt32</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="af3cb7d2a18e821d2d1cac65334f55e45"></a><!-- doxytag: member="builtins.cpp::lDefineProgramIndex" ref="af3cb7d2a18e821d2d1cac65334f55e45" args="(llvm::Module *module, SymbolTable *symbolTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lDefineProgramIndex </td>
          <td>(</td>
          <td class="paramtype">llvm::Module *&#160;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSymbolTable.html">SymbolTable</a> *&#160;</td>
          <td class="paramname"> <em>symbolTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00486">486</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="sym_8cpp_source.html#l00097">SymbolTable::AddVariable()</a>, <a class="el" href="sym_8h_source.html#l00087">Symbol::constValue</a>, <a class="el" href="ispc_8cpp_source.html#l00054">g</a>, <a class="el" href="llvmutil_8h_source.html#l00070">LLVMTypes::Int32VectorType</a>, <a class="el" href="ispc_8h_source.html#l00057">ISPC_MAX_NVEC</a>, <a class="el" href="sym_8h_source.html#l00096">Symbol::isStatic</a>, <a class="el" href="llvmutil_8cpp_source.html#l00176">LLVMInt32Vector()</a>, <a class="el" href="sym_8h_source.html#l00076">Symbol::name</a>, <a class="el" href="sym_8h_source.html#l00077">Symbol::storagePtr</a>, <a class="el" href="ispc_8h_source.html#l00271">Globals::target</a>, <a class="el" href="sym_8h_source.html#l00084">Symbol::type</a>, <a class="el" href="type_8h_source.html#l00231">AtomicType::VaryingConstInt32</a>, and <a class="el" href="ispc_8h_source.html#l00182">Target::vectorWidth</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="a1321254c115cc19f6b414c8eceb0ff7f"></a><!-- doxytag: member="builtins.cpp::lLLVMTypeToISPCType" ref="a1321254c115cc19f6b414c8eceb0ff7f" args="(const llvm::Type *t, bool intAsUnsigned)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const <a class="el" href="classType.html">Type</a>* lLLVMTypeToISPCType </td>
          <td>(</td>
          <td class="paramtype">const llvm::Type *&#160;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"> <em>intAsUnsigned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Given an LLVM type, try to find the equivalent ispc type. Note that this is an under-constrained problem due to LLVM's type representations carrying less information than ispc's. (For example, LLVM doesn't distinguish between signed and unsigned integers in its types.)</p>
<p>Because this function is only used for generating ispc declarations of functions defined in LLVM bitcode in the stdlib-*.ll files, in practice we can get enough of what we need for the relevant cases to make things work, partially with the help of the intAsUnsigned parameter, which indicates whether LLVM integer types should be treated as being signed or unsigned. </p>

<p>Definition at line <a class="el" href="builtins_8cpp_source.html#l00078">78</a> of file <a class="el" href="builtins_8cpp_source.html">builtins.cpp</a>.</p>

<p>References <a class="el" href="llvmutil_8h_source.html#l00055">LLVMTypes::BoolType</a>, <a class="el" href="llvmutil_8h_source.html#l00065">LLVMTypes::DoublePointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00064">LLVMTypes::DoubleType</a>, <a class="el" href="llvmutil_8h_source.html#l00077">LLVMTypes::DoubleVectorPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00076">LLVMTypes::DoubleVectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00063">LLVMTypes::FloatPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00062">LLVMTypes::FloatType</a>, <a class="el" href="llvmutil_8h_source.html#l00075">LLVMTypes::FloatVectorPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00074">LLVMTypes::FloatVectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00059">LLVMTypes::Int32PointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00058">LLVMTypes::Int32Type</a>, <a class="el" href="llvmutil_8h_source.html#l00071">LLVMTypes::Int32VectorPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00070">LLVMTypes::Int32VectorType</a>, <a class="el" href="llvmutil_8h_source.html#l00061">LLVMTypes::Int64PointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00060">LLVMTypes::Int64Type</a>, <a class="el" href="llvmutil_8h_source.html#l00073">LLVMTypes::Int64VectorPointerType</a>, <a class="el" href="llvmutil_8h_source.html#l00072">LLVMTypes::Int64VectorType</a>, <a class="el" href="parse_8yy.html">NULL</a>, <a class="el" href="type_8h_source.html#l00223">AtomicType::UniformBool</a>, <a class="el" href="type_8h_source.html#l00229">AtomicType::UniformDouble</a>, <a class="el" href="type_8h_source.html#l00226">AtomicType::UniformFloat</a>, <a class="el" href="type_8h_source.html#l00224">AtomicType::UniformInt32</a>, <a class="el" href="type_8h_source.html#l00227">AtomicType::UniformInt64</a>, <a class="el" href="type_8h_source.html#l00225">AtomicType::UniformUInt32</a>, <a class="el" href="type_8h_source.html#l00228">AtomicType::UniformUInt64</a>, <a class="el" href="type_8h_source.html#l00229">AtomicType::VaryingDouble</a>, <a class="el" href="type_8h_source.html#l00226">AtomicType::VaryingFloat</a>, <a class="el" href="type_8h_source.html#l00224">AtomicType::VaryingInt32</a>, <a class="el" href="type_8h_source.html#l00227">AtomicType::VaryingInt64</a>, <a class="el" href="type_8h_source.html#l00225">AtomicType::VaryingUInt32</a>, <a class="el" href="type_8h_source.html#l00228">AtomicType::VaryingUInt64</a>, <a class="el" href="type_8h_source.html#l00237">AtomicType::Void</a>, and <a class="el" href="llvmutil_8h_source.html#l00053">LLVMTypes::VoidType</a>.</p>

<p>Referenced by <a class="el" href="builtins_8cpp_source.html#l00147">lCreateISPCSymbol()</a>.</p>

</div>
</div>
<a class="anchor" id="a14866839501f9788fa33614be98acd4f"></a><!-- doxytag: member="builtins.cpp::yy_scan_string" ref="a14866839501f9788fa33614be98acd4f" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">yy_buffer_state* yy_scan_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="module_8cpp_source.html#l00145">Module::CompileFile()</a>, and <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
<a class="anchor" id="acd8617a8f2ac0de8bc1cc032cf449e19"></a><!-- doxytag: member="builtins.cpp::yyparse" ref="acd8617a8f2ac0de8bc1cc032cf449e19" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yyparse </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="module_8cpp_source.html#l00145">Module::CompileFile()</a>, and <a class="el" href="builtins_8cpp_source.html#l00506">DefineStdlib()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sun Jul 17 2011 16:54:28 for Intel SPMD Program Compiler by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
